<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DELETE Page</title>
<link rel="stylesheet" href="../styles.css">
</head>

<script>

const goBack = () => {
	window.history.back();
};

const fetchFiles = () => {
	fetch('/get-files')
	.then(response => response.json())
	.then(files => {
		let fileList = document.getElementById('fileList');
		if (fileList) {
			fileList.remove();
		}
		if (files.length === 0) {
			const noFilesMsg = document.createElement('p');
            noFilesMsg.textContent = "No files found. Please upload some files first!";
            document.body.appendChild(noFilesMsg);
		} else {
			fileList = document.createElement('ul');
			fileList.id = "fileList";
			files.forEach(file => {
				const li = document.createElement('li');
				li.textContent = file;
				const deleteButton = document.createElement('button');
				deleteButton.textContent = 'X';
				deleteButton.onclick = () => deleteFile(file);
				li.appendChild(deleteButton);
				fileList.appendChild(li);
			});
			document.body.appendChild(fileList);
		}
	})
	.catch((e) => {
		console.log(e);
		alert(e);
	})
}

window.onload = () => {
	fetchFiles();
};

function deleteFile(fileName) {
	const url = origin + `/delete-file`
	fetch(url, { 
		method: 'DELETE',
		headers: {
			'Content-Type': 'application/json'
		},
		body: fileName
	})
	.then(() => {
		fetchFiles();
		alert("Deleted file: " + fileName);
	})
	.catch((e) => {
		console.log(e);
		alert(e);
	})
}

</script>

<body class="background">

<button onclick="fetch(origin + '/uploads/text.txt', {method: 'DELETE'})">Delete</button>

<div class="content">
	This is the DELETE page. Here you can simulate a DELETE request.
</div>

</body>
</html>
